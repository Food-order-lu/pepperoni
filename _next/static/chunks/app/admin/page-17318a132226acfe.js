(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{8079:function(e,a,n){Promise.resolve().then(n.bind(n,9738))},9738:function(e,a,n){"use strict";n.r(a),n.d(a,{default:function(){return u}});var r=n(7437),t=n(2265),s=n(6410);let i=function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:800;return new Promise((n,r)=>{let t=new FileReader;t.readAsDataURL(e),t.onload=e=>{var t;let s=new Image;s.src=null===(t=e.target)||void 0===t?void 0:t.result,s.onload=()=>{let e=document.createElement("canvas"),t=s.width,i=s.height;t>a&&(i=Math.round(i*a/t),t=a),e.width=t,e.height=i;let o=e.getContext("2d");if(!o){r(Error("Could not get canvas context"));return}o.drawImage(s,0,0,t,i),e.toBlob(e=>{e?n(e):r(Error("Could not compress image"))},"image/jpeg",.6)},s.onerror=e=>r(e)},t.onerror=e=>r(e)})};var o=n(7356),l=n.n(o);function u(){let[e,a]=(0,t.useState)(!1),[n,o]=(0,t.useState)(""),[u,c]=(0,t.useState)(""),[d,p]=(0,t.useState)(""),[m,g]=(0,t.useState)(!1),[_,h]=(0,t.useState)(""),[v,f]=(0,t.useState)(!1),[x,j]=(0,t.useState)(!0);(0,t.useEffect)(()=>{"true"===sessionStorage.getItem("pepperoni_admin")&&a(!0),(async()=>{let e=await (0,s.N)();e&&p(e),j(!1)})()},[]),(0,t.useEffect)(()=>{let e=e=>{m&&(e.preventDefault(),e.returnValue="")};return window.addEventListener("beforeunload",e),()=>window.removeEventListener("beforeunload",e)},[m]);let w=async e=>{var a;let n=null===(a=e.target.files)||void 0===a?void 0:a[0];if(n){g(!0),f(!1),c(""),h("Optimisation de l'image...");try{let e=await i(n);h("Upload en cours...");let a=new FormData;a.append("file",e),a.append("upload_preset","Menu de la semaine pepperoni");let r=await fetch("https://api.cloudinary.com/v1_1/".concat("dsk1mj71x","/image/upload"),{method:"POST",body:a}),t=await r.json();t.secure_url?(h("Sauvegarde..."),await (0,s.v)(t.secure_url)?(p(t.secure_url),f(!0)):c("Image upload\xe9e mais erreur lors de la sauvegarde. R\xe9essayez.")):c("Erreur lors de l'upload. V\xe9rifiez la configuration Cloudinary.")}catch(e){c("Erreur de connexion. R\xe9essayez."),console.error(e)}finally{g(!1),h("")}}};return e?(0,r.jsx)("div",{className:l().container,children:(0,r.jsxs)("div",{className:l().adminPanel,children:[(0,r.jsxs)("div",{className:l().header,children:[(0,r.jsx)("h1",{children:"\uD83C\uDF55 Gestion du Menu"}),(0,r.jsx)("button",{onClick:()=>{a(!1),sessionStorage.removeItem("pepperoni_admin")},className:l().logoutBtn,children:"D\xe9connexion"})]}),(0,r.jsxs)("div",{className:l().uploadSection,children:[(0,r.jsx)("h2",{children:"\uD83D\uDCCB Menu de la Semaine"}),(0,r.jsx)("p",{children:"Uploadez une nouvelle image pour mettre \xe0 jour le menu affich\xe9 sur le site."}),(0,r.jsx)("p",{className:l().infoText,children:"✨ L'image sera visible par tous les visiteurs du site !"}),(0,r.jsxs)("label",{className:l().uploadLabel,children:[(0,r.jsx)("input",{type:"file",accept:"image/*",onChange:w,className:l().fileInput,disabled:m}),(0,r.jsx)("span",{className:l().uploadBtn,children:m?_||"⏳ Traitement...":"\uD83D\uDCE4 Choisir une image"})]}),u&&(0,r.jsxs)("div",{className:l().errorBox,children:["❌ ",u]}),v&&(0,r.jsx)("div",{className:l().success,children:"✅ Image mise \xe0 jour avec succ\xe8s ! Tous les visiteurs peuvent maintenant la voir."})]}),(0,r.jsxs)("div",{className:l().previewSection,children:[(0,r.jsx)("h3",{children:"Aper\xe7u actuel"}),x?(0,r.jsx)("div",{className:l().noImage,children:"Chargement..."}):d?(0,r.jsx)("img",{src:d,alt:"Menu de la semaine",className:l().previewImage}):(0,r.jsx)("div",{className:l().noImage,children:"Aucune image de menu upload\xe9e"})]})]})}):(0,r.jsx)("div",{className:l().container,children:(0,r.jsxs)("div",{className:l().loginCard,children:[(0,r.jsx)("div",{className:l().logo,children:"\uD83C\uDF55"}),(0,r.jsx)("h1",{children:"Administration Pepperoni"}),(0,r.jsx)("p",{children:"Connectez-vous pour g\xe9rer le menu de la semaine"}),(0,r.jsxs)("form",{onSubmit:e=>{e.preventDefault(),"Pepperoni2022"===n?(a(!0),sessionStorage.setItem("pepperoni_admin","true"),c("")):c("Mot de passe incorrect")},className:l().form,children:[(0,r.jsx)("input",{type:"password",placeholder:"Mot de passe",value:n,onChange:e=>o(e.target.value),className:l().input}),u&&(0,r.jsx)("p",{className:l().error,children:u}),(0,r.jsx)("button",{type:"submit",className:l().button,children:"Se connecter"})]})]})})}},6410:function(e,a,n){"use strict";n.d(a,{N:function(){return l},v:function(){return o}});var r=n(738),t=n(5978);let s=(0,r.ZF)({apiKey:"AIzaSyDjFl9aA4B8dtMmhBCfzp7L1VgWaUYOa7U",authDomain:"pepperoni-menu.firebaseapp.com",projectId:"pepperoni-menu",storageBucket:"pepperoni-menu.firebasestorage.app",messagingSenderId:"99813985360",appId:"1:99813985360:web:1d226c62a52c49f51a5555",measurementId:"G-R7FVEX4T7E"}),i=(0,t.ad)(s);async function o(e){try{return await (0,t.pl)((0,t.JU)(i,"settings","menu"),{imageUrl:e,updatedAt:new Date().toISOString()}),!0}catch(e){return console.error("Erreur lors de la sauvegarde:",e),!1}}async function l(){try{let e=await (0,t.QT)((0,t.JU)(i,"settings","menu"));if(e.exists())return e.data().imageUrl;return null}catch(e){return console.error("Erreur lors du chargement:",e),null}}},7356:function(e){e.exports={container:"page_container__bKlsu",loginCard:"page_loginCard__g_zoW",logo:"page_logo__2iuHa",form:"page_form__0FWwx",input:"page_input__LzCRz",button:"page_button__XbX_N",error:"page_error__J8EiX",adminPanel:"page_adminPanel__93XMV",header:"page_header__GFEq6",logoutBtn:"page_logoutBtn__Qx2MZ",uploadSection:"page_uploadSection___HSuz",uploadLabel:"page_uploadLabel__3b4XN",fileInput:"page_fileInput__ndibQ",uploadBtn:"page_uploadBtn__Ghf4O",success:"page_success__wK9AJ",infoText:"page_infoText__WEbT3",errorBox:"page_errorBox__Zrt_3",previewSection:"page_previewSection__BL4tO",previewImage:"page_previewImage__CIkTb",noImage:"page_noImage__52vm3"}}},function(e){e.O(0,[491,609,448,971,117,744],function(){return e(e.s=8079)}),_N_E=e.O()}]);